# Python GUI 打包编译工具项目方案

## 项目概述

本项目旨在开发一个基于 Python 的 CTK (CustomTkinter) 库和标准库 TTK 的 GUI 应用程序，用于打包和编译 Python 项目。该工具将集成 pyinstaller 和 nuitka 两种主流的 Python 打包工具，提供直观的图形界面来配置和执行打包操作。

## 技术栈

- **GUI 框架**: CustomTkinter (CTK) + TTK
- **打包工具**: PyInstaller + Nuitka
- **编程语言**: Python 3.8+
- **操作系统**: Windows (主要目标)

## 项目结构

```
py_pack_gui/
├── main.py                 # 主程序入口
├── requirements.txt        # 依赖包列表
├── assets/                 # 资源文件夹
│   ├── icons/             # 图标文件
│   └── themes/            # 主题文件
├── core/                  # 核心功能模块
│   ├── __init__.py
│   ├── project_manager.py # 项目管理模块
│   ├── pyinstaller_wrapper.py  # PyInstaller封装
│   └── nuitka_wrapper.py  # Nuitka封装
├── ui/                    # 用户界面模块
│   ├── __init__.py
│   ├── main_window.py     # 主窗口
│   ├── sidebar.py         # 侧边栏
│   ├── project_page.py    # 项目管理页面
│   ├── build_page.py      # 打包编译页面
│   ├── pyinstaller_tab.py # PyInstaller标签页
│   ├── nuitka_tab.py      # Nuitka标签页
│   └── process_page.py    # 打包过程页面
├── utils/                 # 工具模块
│   ├── __init__.py
│   ├── config_manager.py  # 配置管理
│   ├── file_utils.py      # 文件操作工具
│   └── logger.py          # 日志记录
└── data/                  # 数据文件夹
    ├── projects.json      # 项目列表
    └── settings.json      # 应用设置
```

## 功能模块设计

### 1. 主窗口模块 (main_window.py)

- **功能**: 应用程序的主窗口，包含整体布局
- **组件**:
  - 左侧导航栏
  - 主内容区域
  - 顶部菜单栏
  - 底部状态栏

### 2. 侧边栏模块 (sidebar.py)

- **功能**: 提供页面导航功能
- **组件**:
  - 项目管理按钮
  - 打包编译按钮
  - 设置按钮
  - 关于按钮

### 3. 项目管理界面 (project_page.py)

- **功能**: 管理Python项目
- **组件**:
  - 项目列表视图
  - 添加项目按钮
  - 删除项目按钮
  - 编辑项目按钮
  - 打开项目按钮
  - 项目详情面板

### 4. 打包编译界面 (build_page.py)

- **功能**: 提供打包工具选择和配置
- **组件**:
  - 标签页控件 (PyInstaller/Nuitka)
  - 项目信息显示
  - 开始打包按钮

### 5. PyInstaller标签页 (pyinstaller_tab.py)

- **功能**: 配置PyInstaller打包参数
- **组件**:
  - 脚本路径选择
  - 输出目录选择
  - 打包模式选择 (单文件/单目录)
  - 附加参数输入框
  - 高级选项折叠面板
  - 常用参数预设

### 6. Nuitka标签页 (nuitka_tab.py)

- **功能**: 配置Nuitka打包参数
- **组件**:
  - 脚本路径选择
  - 输出目录选择
  - 编译选项 (独立模式/模块模式)
  - 优化级别选择
  - 包含/排除模块配置
  - 高级选项折叠面板
  - 常用参数预设

### 7. 打包过程界面 (process_page.py)

- **功能**: 显示打包过程和结果
- **组件**:
  - 输出文本框
  - 复制输出按钮
  - 清空输出按钮
  - 停止打包按钮
  - 进度条
  - 状态指示器

## 核心功能流程

### 1. 项目管理流程

1. 用户启动应用程序
2. 进入项目管理界面
3. 可以添加、编辑、删除Python项目
4. 选择项目并点击"打开"进入打包界面

### 2. 打包编译流程

1. 在项目管理界面选择项目
2. 进入打包编译界面
3. 选择打包工具 (PyInstaller/Nuitka)
4. 配置打包参数
5. 点击"开始打包"
6. 跳转到打包过程界面
7. 显示打包进度和输出
8. 打包完成后显示结果

## 参数配置方案

### PyInstaller 主要参数

- **基础参数**:
  - 脚本路径 (`--name`, `--onefile`, `--onedir`)
  - 输出目录 (`--distpath`)
  - 工作目录 (`--workpath`)
  - 规格文件路径 (`--specpath`)

- **高级参数**:
  - 图标 (`--icon`)
  - 添加数据文件 (`--add-data`)
  - 隐藏导入 (`--hidden-import`)
  - 排除模块 (`--exclude-module`)
  - UPX压缩 (`--upx-dir`)
  - 控制台/窗口模式 (`--console`, `--windowed`, `--noconsole`)

### Nuitka 主要参数

- **基础参数**:
  - 脚本路径
  - 输出目录 (`--output-dir`)
  - 独立模式 (`--standalone`)
  - 模块模式 (`--module`)

- **高级参数**:
  - Python版本 (`--python-version`)
  - 包含包 (`--include-package`)
  - 包含模块 (`--include-module`)
  - 排除模块 (`--nofollow-import-to`)
  - 优化级别 (`--lto`, `--clang`)
  - 插件 (`--plugin-enable`)

## 数据存储方案

### 1. 项目数据 (projects.json)

```json
{
  "projects": [
    {
      "id": "unique_id",
      "name": "项目名称",
      "path": "项目路径",
      "main_script": "主脚本路径",
      "description": "项目描述",
      "last_build_time": "最后打包时间",
      "pyinstaller_config": {
        "name": "",
        "onefile": false,
        "icon": "",
        "add_data": [],
        "hidden_import": [],
        "exclude_module": [],
        "console": true
      },
      "nuitka_config": {
        "standalone": true,
        "include_package": [],
        "include_module": [],
        "nofollow_import_to": [],
        "python_version": "",
        "plugins": []
      }
    }
  ]
}
```

### 2. 应用设置 (settings.json)

```json
{
  "theme": "dark",
  "language": "zh_CN",
  "default_output_dir": "默认输出目录",
  "auto_save_config": true,
  "recent_projects": ["项目ID1", "项目ID2"],
  "pyinstaller_path": "PyInstaller可执行文件路径",
  "nuitka_path": "Nuitka可执行文件路径"
}
```

## 用户界面设计

### 1. 主界面布局

```
+--------------------------------------+
|           菜单栏                    |
+------+-------------------------------+
|      |                               |
|      |                               |
| 侧   |                               |
| 边   |         主内容区域             |
| 栏   |                               |
|      |                               |
|      |                               |
+------+-------------------------------+
|           状态栏                    |
+--------------------------------------+
```

### 2. 项目管理界面

```
+--------------------------------------+
|  [新建] [编辑] [删除] [打开]          |
+--------------------------------------+
|                                      |
|         项目列表                     |
|                                      |
|  +------------------------------+   |
|  | 项目1                        |   |
|  +------------------------------+   |
|  | 项目2                        |   |
|  +------------------------------+   |
|  | ...                          |   |
|  +------------------------------+   |
|                                      |
+--------------------------------------+
|          项目详情                    |
+--------------------------------------+
```

### 3. 打包编译界面

```
+--------------------------------------+
|  项目: [项目名称]                    |
+--------------------------------------+
|  [PyInstaller] [Nuitka]              |
+--------------------------------------+
|                                      |
|          打包配置区域                 |
|                                      |
|  脚本路径: [__________] [浏览]       |
|  输出目录: [__________] [浏览]       |
|  ... 其他配置项 ...                  |
|                                      |
+--------------------------------------+
|           [开始打包]                 |
+--------------------------------------+
```

### 4. 打包过程界面

```
+--------------------------------------+
|  状态: [打包中...]    [停止]         |
+--------------------------------------+
|  进度: [████████████░░░░] 75%        |
+--------------------------------------+
|                                      |
|          输出文本框                   |
|  +--------------------------------+  |
|  | 正在编译...                   |  |
|  | 处理文件...                   |  |
|  | ...                           |  |
|  | 打包完成!                     |  |
|  +--------------------------------+  |
|                                      |
+--------------------------------------+
|  [复制输出] [清空输出] [打开输出目录] |
+--------------------------------------+
```

## 错误处理与日志

### 1. 错误处理策略

- **文件路径错误**: 检查路径有效性，提供友好的错误提示
- **打包工具错误**: 捕获打包工具的输出，解析错误信息
- **配置错误**: 验证用户输入的参数有效性
- **系统错误**: 处理权限、空间等系统级错误

### 2. 日志记录

- **应用日志**: 记录应用操作和错误
- **打包日志**: 记录打包过程的详细输出
- **用户操作日志**: 记录用户的操作历史

## 扩展功能

### 1. 高级功能

- **批量打包**: 支持同时打包多个项目
- **打包模板**: 创建和应用打包配置模板
- **自动更新**: 检查和更新打包工具版本
- **插件系统**: 支持第三方打包工具插件

### 2. 未来计划

- **跨平台支持**: 扩展到Linux和macOS
- **云端打包**: 支持远程打包服务
- **CI/CD集成**: 与持续集成工具集成
- **性能分析**: 分析打包后的程序性能

## 开发计划

### 第一阶段: 基础框架

1. 创建项目结构
2. 实现主窗口和侧边栏
3. 实现项目管理界面
4. 实现基本的项目数据存储

### 第二阶段: 打包功能

1. 实现PyInstaller标签页和参数配置
2. 实现Nuitka标签页和参数配置
3. 实现打包过程界面
4. 集成PyInstaller和Nuitka调用

### 第三阶段: 优化与扩展

1. 完善错误处理和日志记录
2. 添加高级配置选项
3. 实现打包模板功能
4. 优化用户体验

## 技术难点与解决方案

### 1. 打包工具输出解析

- **问题**: 不同打包工具的输出格式不同，难以统一解析
- **解决方案**: 为每种打包工具实现专门的输出解析器，提取关键信息

### 2. 长时间运行的打包操作

- **问题**: 打包操作可能耗时很长，需要避免界面卡顿
- **解决方案**: 使用多线程执行打包操作，通过队列传递输出信息

### 3. 参数配置复杂性

- **问题**: PyInstaller和Nuitka参数众多，用户难以配置
- **解决方案**: 提供参数预设和向导式配置，简化常用场景的配置

## 总结

本项目旨在创建一个用户友好的Python打包工具GUI，通过集成PyInstaller和Nuitka，提供直观的界面来配置和执行打包操作。项目将分阶段开发，首先实现基础功能，然后逐步添加高级特性，最终打造一个功能完善、易于使用的Python打包工具。